# 点云存储

## 分布式下 MongoDB 对激光点云的存储和处理研究 

​	近年来，激光点云数据的应用急剧增加，如何对其进行高效存储和快速处理成为当前的一个重要研究方向。

​	点云数据包含着丰富的地理信息，属于空间数据范畴。

​	传统的关系型数据库对海量空间数据的存储和处理相对薄弱，分布式环境下非关系型数据库的应用为此提供了一个新的研究视角。

​	Sharding 技术是数据库水平扩展的一种解决方案，在分布式环境下搭建 MongoDB 的 Sharding 集群，通过范围分片和哈希分片对大量激光点云数据进行分布式存储、空间查询和 MapReduce 运算测试，充分体现了分布式下 MongoDB 在空间数据的存储和处理方面的巨大优势。 

​	







## 大规模点云内外存调度绘制技术

​	201401 张毅 武汉大学

​	为实现大规模点云的快速绘制，提出以部分内存访问机制为基础、以节点点数上限为叶节点形成条件的平衡八叉树存储结构 。设计点云内外存调度绘制流程 ，包括节点可见性判断、内外存数据调度和点云绘制等环节。为提高可见性判断的效率，在视点与节点距离、夹角约束条件基础上给出节点可视半径约束。利用实测大规模点云数据进行实验，结果证明，该技术可以在有限的内存资源条件下，以较小的内存消耗实现上亿级规模点云从整体到局部的流畅绘制。



​	点云数据无论是来自原始扫描文件，还是由处理软件导出，都是以顺序方式存储。这种文件内的顺序并不一定对应于空间关系上的顺序。点云的空间关系对于点云绘制十分重要。在三维视图中，利用点云空间关系可以提高点云调度的效率，方便可视判断和 LOD设计。点云的空间关系通过点云存储结构来表达，可以采用的存储结构有规则存储、八叉树存储和K-D树存储等。规则存储实现简单，但空间冗余大。K-D树存储主要有利于邻域查找，但在随视点变化的三维绘制和LOD设计中存在一定问题。八叉树结构按照从整体到局部的形式逐层进行点云存储，空间关系通过父子节点进行连接，无空间冗余，比较适合三维绘制。

​	点云的存储结构分为内存结构和外存结构，如图 1 所示。内存结构是严格的八叉树结构，节点 node 包含了该节点的外包盒坐标、点号集合 ptlD、点号集合对应的点记录指针 pt，以及 8个子节点指针 next。



​	其中，点号集合对应的点记录指针 pt 在建立八叉树过程中不占用内存空间，而是在从外存读入数据后进行绘制时占用内存。因此，在八叉树建立过程中真正占用内存空间的主要是点号集合 ptlD。在32位操作系统中，一个 long 型点号仅占用 4 Byte，而一个点坐标需要 3 个 float 型，占用 12 Byte，因而在八叉树中存储点号可以节约内存空间。外存结构是将内存按节点逐一进行存储，通过文件指针偏移量 offset 来标记当前节点在整个文件中的位置，有利于快速查找。当八叉树内存结构建立完成后，采用广度优先递归方式遍历整个树结构，逐节点写到外存文件中。当绘制点云时，根据需要可以将特定的节点及其点云读入内存节点中。 